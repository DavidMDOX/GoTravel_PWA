<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Go Travel · 单文件诊断版</title>

  <!-- 直接在这里写死你的运行页 URL，完全绕过 config.js -->
  <script>
    window.HF_SPACE_URL = "https://davidmdox-gotravel-uipro.hf.space";
  </script>

  <style>
    *{box-sizing:border-box} html,body{margin:0;padding:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto}
    .wrap{max-width:900px;margin:24px auto;padding:0 12px}
    .card{border:1px solid #d1d5db;border-radius:12px;padding:16px;background:#fff}
    .hint{color:#0b766e} .err{color:#b91c1c} .small{font-size:12px;color:#6b7280}
    iframe{width:100%;height:70vh;border:0;border-radius:12px;background:#fff}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Go Travel（单文件诊断版）</h1>
    <div class="card" id="statusBox">
      <div id="status">正在读取 <code>HF_SPACE_URL</code> …</div>
      <div class="small">若长时间无变化，请按 Ctrl/⌘+Shift+R 强制刷新；如果以前注册过 Service Worker，请在 DevTools → Application → Service Workers → Unregister。</div>
    </div>

    <div class="card" style="margin-top:16px">
      <iframe id="hfFrame" title="Hugging Face App"></iframe>
    </div>
  </div>

  <script>
    (async function(){
      const status = document.getElementById('status');
      const frame  = document.getElementById('hfFrame');

      // 打印 SW 情况（便于你看是否还在用旧缓存）
      if ('serviceWorker' in navigator) {
        const regs = await navigator.serviceWorker.getRegistrations();
        if (regs.length) {
          status.insertAdjacentHTML('beforeend','<div class="hint">检测到已有 Service Worker，建议先 Unregister 后再刷新。</div>');
          console.log('ServiceWorkers:', regs);
        }
      }

      const url = window.HF_SPACE_URL;
      console.log('HF_SPACE_URL =', url);
      status.innerHTML = '配置：<code>' + url + '</code>';

      // 基本校验
      if (!/^https?:\/\/.+\.hf\.space\/?$/.test(url)) {
        status.insertAdjacentHTML('beforeend', '<div class="err">不是 .hf.space 运行页格式，请核对。</div>');
        return;
      }

      frame.addEventListener('load', ()=> {
        status.insertAdjacentHTML('beforeend', '<div class="hint">iframe 已加载。</div>');
      });
      frame.addEventListener('error', ()=> {
        status.insertAdjacentHTML('beforeend', '<div class="err">iframe 加载失败（可能被目标站点禁止嵌入，或网络问题）。</div>');
      });

      frame.src = url;
    })();
  </script>

  <!-- 诊断期先不注册 SW，避免缓存干扰；跑通后再恢复 -->
</body>
</html>
